import{r as L}from"./rolldown-runtime-km5iIlDX.js";import{b as S}from"./chart-vendor-BxLEm8EH.js";import{f as n,u as z,v as M,y as _}from"./react-vendor-B8Gnojlf.js";import{n as $,r as D,t as q}from"./index-BgP2VN91.js";import{i as f}from"./demoData-CY-vniqt.js";var r=L(S(),1),e=z(),I=()=>{const{id:l}=_(),{isAuthenticated:o,isDemo:y}=$();M();const[s,c]=(0,r.useState)(null),[p,x]=(0,r.useState)([]),[a,N]=(0,r.useState)(null),[i,d]=(0,r.useState)({prevLesson:null,nextLesson:null}),[k,j]=(0,r.useState)(!0),[g,b]=(0,r.useState)(""),[w,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{if(j(!0),o){const t=await D.getLesson(l);c(t.data.lesson),x(t.data.quizzes||[]),N(t.data.userProgress),d(t.data.navigation),u(y)}else{u(!0);const t=f(l);t?(c(t.lesson),x(t.quizzes),d(t.navigation)):b("Lesson tidak ditemukan.")}}catch(t){console.error("Error fetching lesson:",t);const m=f(l);m?(c(m.lesson),x(m.quizzes),d(m.navigation),u(!0)):b("Lesson tidak ditemukan.")}finally{j(!1)}})()},[l,o]);const v=s?(h=>{if(!h)return null;const t=h.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);return t&&t[2].length===11?t[2]:null})(s.video_url||s.youtube_url):null;return k?(0,e.jsx)("div",{className:"page-container py-12",children:(0,e.jsx)("div",{className:"container-main",children:(0,e.jsx)(q,{size:"lg",text:"Memuat pembahasan..."})})}):g||!s?(0,e.jsx)("div",{className:"page-container py-12",children:(0,e.jsxs)("div",{className:"container-main text-center",children:[(0,e.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Pembahasan tidak ditemukan"}),(0,e.jsx)("p",{className:"text-gray-500 mb-4",children:g}),(0,e.jsx)(n,{to:"/courses",className:"btn-primary",children:"Kembali ke Materi TKA"})]})}):(0,e.jsx)("div",{className:"page-container py-4 sm:py-6",children:(0,e.jsxs)("div",{className:"container-main px-3 sm:px-4",children:[w&&!o&&!1,s.course&&(0,e.jsxs)("div",{className:"card p-4 sm:p-6 mb-4 sm:mb-6",children:[(0,e.jsx)("span",{className:"inline-block px-2 sm:px-3 py-0.5 sm:py-1 bg-primary-100 text-primary-700 text-xs sm:text-sm font-medium rounded-full mb-2 sm:mb-3",children:s.course.category}),(0,e.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-1 sm:mb-2",children:s.course.title}),(0,e.jsx)("p",{className:"text-gray-600 text-xs sm:text-base mb-2 sm:mb-4",children:s.course.description})]}),(0,e.jsxs)("nav",{className:"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm text-gray-500 mb-4 sm:mb-6 flex-wrap",children:[(0,e.jsx)(n,{to:"/courses",className:"hover:text-primary-600",children:"TKA"}),(0,e.jsx)("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,e.jsx)(n,{to:`/lesson/${s.id}`,className:"hover:text-primary-600 truncate max-w-[100px] sm:max-w-none",children:s.title})]}),(0,e.jsxs)("div",{className:"grid lg:grid-cols-3 gap-4 sm:gap-8",children:[(0,e.jsxs)("div",{className:"lg:col-span-2",children:[(s.video_url||s.youtube_url)&&(0,e.jsx)("div",{className:"card overflow-hidden mb-4 sm:mb-6",children:v?(0,e.jsx)("div",{className:"video-container",children:(0,e.jsx)("iframe",{src:`https://www.youtube.com/embed/${v}?rel=0&modestbranding=1`,title:s.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,loading:"lazy"})}):(0,e.jsx)("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:(0,e.jsxs)("div",{className:"text-center text-gray-500",children:[(0,e.jsx)("svg",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})}),(0,e.jsx)("p",{className:"text-sm",children:"Video tidak tersedia"})]})})}),(0,e.jsxs)("div",{className:"card p-3 sm:p-6 mb-4 sm:mb-6",children:[(0,e.jsx)("h1",{className:"text-lg sm:text-2xl font-bold text-gray-900 mb-2 sm:mb-4",children:s.title}),s.module&&(0,e.jsxs)("p",{className:"text-gray-500 mb-2 sm:mb-4 text-xs sm:text-base",children:[(0,e.jsx)("span",{className:"font-medium",children:"Module:"})," ",s.module.title]}),s.summary&&(0,e.jsxs)("div",{className:"prose prose-gray max-w-none prose-sm sm:prose-base",children:[(0,e.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-1 sm:mb-2",children:"Ringkasan"}),(0,e.jsx)("p",{className:"text-gray-600 whitespace-pre-line text-sm sm:text-base",children:s.summary})]})]}),p.length>0&&(0,e.jsx)("div",{className:"card p-3 sm:p-6 mb-4 sm:mb-6",children:(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-0",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Latihan Soal"}),(0,e.jsxs)("p",{className:"text-gray-500 text-xs sm:text-sm mt-1",children:[p.length," soal â€¢ Min 70%"]}),a&&(0,e.jsx)("p",{className:`text-xs sm:text-sm mt-1 sm:mt-2 font-medium ${a.completed?"text-green-600":"text-orange-600"}`,children:a.completed?`Skor: ${a.score}%`:`Skor terakhir: ${a.score}%`})]}),(0,e.jsx)(n,{to:`/quiz/${l}`,className:"btn-primary text-sm sm:text-base py-2 px-3 sm:py-2.5 sm:px-4 w-full sm:w-auto text-center",children:a?"Ulangi":"Mulai"})]})}),(0,e.jsxs)("div",{className:"flex justify-between items-center mt-4 sm:mt-6 gap-2",children:[i.prevLesson?(0,e.jsxs)(n,{to:`/lesson/${i.prevLesson.id}`,className:"flex items-center text-gray-600 hover:text-primary-600 transition-colors flex-1 min-w-0",children:[(0,e.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1 sm:mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(0,e.jsxs)("div",{className:"text-left min-w-0",children:[(0,e.jsx)("p",{className:"text-xs text-gray-400 hidden sm:block",children:"Sebelumnya"}),(0,e.jsx)("p",{className:"font-medium text-xs sm:text-base truncate",children:i.prevLesson.title})]})]}):(0,e.jsx)("div",{className:"flex-1"}),i.nextLesson?(0,e.jsxs)(n,{to:`/lesson/${i.nextLesson.id}`,className:"flex items-center text-gray-600 hover:text-primary-600 transition-colors flex-1 min-w-0 justify-end",children:[(0,e.jsxs)("div",{className:"text-right min-w-0",children:[(0,e.jsx)("p",{className:"text-xs text-gray-400 hidden sm:block",children:"Selanjutnya"}),(0,e.jsx)("p",{className:"font-medium text-xs sm:text-base truncate",children:i.nextLesson.title})]}),(0,e.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 ml-1 sm:ml-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):(0,e.jsx)("div",{className:"flex-1"})]})]}),(0,e.jsx)("div",{className:"hidden lg:block lg:col-span-1",children:(0,e.jsxs)("div",{className:"card p-4 sm:p-6 sticky top-24",children:[(0,e.jsx)("h3",{className:"font-semibold text-gray-900 mb-3 sm:mb-4 text-sm sm:text-base",children:"Status"}),(0,e.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,e.jsxs)("div",{className:`p-3 sm:p-4 rounded-lg ${a?.completed?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"}`,children:[(0,e.jsx)("div",{className:"flex items-center",children:a?.completed?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,e.jsx)("span",{className:"text-green-700 font-medium text-sm sm:text-base",children:"Selesai"})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,e.jsx)("span",{className:"text-gray-600 font-medium text-sm sm:text-base",children:"Dalam Progress"})]})}),a?.score!==void 0&&(0,e.jsxs)("p",{className:"text-xs sm:text-sm mt-2 text-gray-600",children:["Skor Quiz:"," ",(0,e.jsxs)("span",{className:"font-semibold",children:[a.score,"%"]})]})]}),s.course&&(0,e.jsx)(n,{to:`/course/${s.course.id}`,className:"btn-outline w-full text-sm sm:text-base",children:"Lihat Semua Materi"})]})]})})]})]})})};export{I as default};
